## Easy :

### 1) Your task would be to create a python script to create an encrypted cookie and brute force the login system to gain access . You can use the request and crypto python libraries
So initially I started looing how to send cookies through python  and forund this:
https://stackoverflow.com/questions/7164679/how-to-send-cookies-in-a-post-request-with-the-python-requests-library

Next i got an idea how to send credentials but even checked again anf forund this :
https://stackoverflow.com/questions/61408628/unable-to-send-login-credentials-via-post-python

Next is print the output with out brackets which I found in gfh.

```py
import requests
import base64
import re
data = {
    "username": "Kit",
    "password": "Kat"
}
cookies = {
    "session_id": base64.b64encode("admin123".encode()).decode()
}
res = requests.post('http://localhost:8080/login', data=data, cookies=cookies)

text = eval(res.text)["flag"]
res = re.findall(r'\{(.*?)\}', text)
print(str(res[0]))
```
output:```H4ck3r```

### 2) Make a one line python program to find whether the given year is leap or not.

this link of Python One-Liner helped me a lot : https://blog.finxter.com/python-one-liners/
```py
f = lambda x: print("leap year" if ((x%400==0) or (x%100!=0) and (x%4==0)) else 'not leap year')
```
![image](https://user-images.githubusercontent.com/78896740/135728302-4830771f-72e3-4a95-83a4-69b157cca6be.png)

## Medium:
Write a chat application using socket programming.
Consider a small chat program with two processes A and B:
A: Establishing Connection over sockets and sending  message/data to the server side/receiver side .
B. Receiving connection and send a message/response back .
Feel free to use any library functions.

Should include the following security features:
● Symmetric key encryption for confidentiality(You can use any algorithm)
● SHA-512 for integrity
● HMAC for message authentication.

So after refering to alot of websites i finally got the right one
https://stackoverflow.com/questions/7749341/basic-python-client-socket-example
in that website it has given me a clear view of what to do and how to make a chat application.


### server script
```py
#server.py
import socket, os, pickle, hashlib, binascii
from Crypto.Cipher import AES
from datetime import datetime
now = datetime.now()
c_time = now.strftime("%H:%M:%S")

lst=[]
def encrypt(msg, secretKey):
    aesCipher = AES.new(secretKey, AES.MODE_GCM)
    ciphertext, authTag = aesCipher.encrypt_and_digest(msg)
    hash1 = (hashlib.sha256(bytes(msg))).hexdigest()
    lst.extend([secretKey,ciphertext, aesCipher.nonce, authTag, hash1])

def decrypt(encryptedMsg1, secretKey1):
    (ciphertext1, nonce1, authTag1 ,hash1) = encryptedMsg1
    aesCipher1 = AES.new(secretKey1, AES.MODE_GCM, nonce1)
    plaintext1 = aesCipher1.decrypt_and_verify(ciphertext1, authTag1)
    hashverify = (hashlib.sha256(bytes(plaintext1))).hexdigest()
    if hashverify == hash1 :
        return plaintext1

secretKey = os.urandom(32)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind(("192.168.1.208", 9999))
s.listen(1)
while True:
    conn , addr = s.accept()
    print(f'IP:{addr} has connected')
    while True:
        received = conn.recv(2048)
        rec_data = pickle.loads(received)
        encryptedMsg1 = (rec_data[1],rec_data[2],rec_data[3],rec_data[4])
        secretKey1 = rec_data[0]
        decrypted_text = decrypt(encryptedMsg1,secretKey1)
        if received == '':
            break
        else:
            print(f"[{c_time}] Client> "+decrypted_text.decode())

        send_msg = input(f'[{c_time}] You> ').replace('b','').encode('utf-8')
        asemsg = encrypt(send_msg , secretKey)
        enc_msg = pickle.dumps(lst)
        if send_msg == '':
            break
        else:
            conn.sendall(enc_msg)
            lst.clear()
```

### client side:

```py
#client.py
import socket, os, pickle, hashlib, binascii
from Crypto.Cipher import AES
from datetime import datetime
now = datetime.now()
c_time = now.strftime("%H:%M:%S")

lst=[]
def encrypt(msg, secretKey):
    aesCipher = AES.new(secretKey, AES.MODE_GCM)
    ciphertext, authTag = aesCipher.encrypt_and_digest(msg)
    hash1 = (hashlib.sha256(bytes(msg))).hexdigest()
    lst.extend([secretKey,ciphertext, aesCipher.nonce, authTag, hash1])

def decrypt(encryptedMsg1, secretKey1):
    (ciphertext1, nonce1, authTag1, hash1) = encryptedMsg1
    aesCipher1 = AES.new(secretKey1, AES.MODE_GCM, nonce1)
    plaintext1 = aesCipher1.decrypt_and_verify(ciphertext1, authTag1)
    hashverify = (hashlib.sha256(bytes(plaintext1))).hexdigest()
    if hashverify == hash1 :
        return plaintext1

secretKey = os.urandom(32)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.208", 9999))
while True:
    s_msg = input(f'[{c_time}] You> ').replace('b', '').encode('utf-8')
    asemsg = encrypt(s_msg , secretKey)
    enc_msg = pickle.dumps(lst)
    if s_msg == '':
        break 
    else:
        s.sendall(enc_msg)
        lst.clear()
    
    r_msg = s.recv(2048)
    rev_data_1 = pickle.loads(r_msg)
    encryptedMsg1 = (rev_data_1[1],rev_data_1[2],rev_data_1[3], rev_data_1[4])
    secretKey1 = rev_data_1[0]
    decrypted_text = decrypt(encryptedMsg1,secretKey1)
    if r_msg == '':
        break
    else:
        print(f"[{c_time}] Client> "+decrypted_text.decode())
```
![](https://github.com/victim1307/Tasks/blob/main/bi0s_pentest/out.gif)


## Hard:
### Sometimes, we'll have to automate stuff in a web browser. Your next task would be automating a file upload feature using selenium web driver , on your preferred browser . For the web app , who's file upload you'll be automating, you can use dvwa . It's easy to install and set up . A simple google search would give resources on how to set it up .

```py
import time
import base64
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
driver = webdriver.Chrome()
driver.get("https://account.protonmail.com/login")
time.sleep(5)
pwd = (base64.b64decode("cHIwdDBubUAhbA==")).decode("UTF-8")
def task():
    selectbox1= driver.find_element_by_xpath('//*[@id="username"]')
    selectbox1.send_keys("qwezxcmp130743")
    time.sleep(1)
    selectbox2= driver.find_element_by_xpath('//*[@id="password"]')
    selectbox2.send_keys(pwd)
    click1 = driver.find_element_by_xpath('/html/body/div[1]/div[3]/div/div/main/div[2]/form/button')
    click1.click()
    time.sleep(20)
    newmsgclick = driver.find_element_by_xpath('/html/body/div[1]/div[3]/div[2]/div/div[1]/div[2]/button')
    newmsgclick.click()
    time.sleep(2)
    sender_mail = driver.find_element_by_xpath('/html/body/div[1]/div[4]/div/div/div/div/div/div[2]/div/div/div/div/div/input')
    sender_mail.send_keys("qwezxcmp130743@gmail.com")
    subject = driver.find_element_by_xpath('/html/body/div[1]/div[4]/div/div/div/div/div/div[3]/input')
    subject.send_keys("Automation")
    upload_img_button = driver.find_element_by_xpath('/html/body/div[1]/div[4]/div/div/div/div/section/div/div/div[2]/button[13]')
    upload_img_button.click()
    upload_pic_button = driver.find_element_by_xpath("//input[@type='file']")
    upload_pic_button.send_keys("/home/victim/Downloads/index.png")
    exit_img_popup = driver.find_element_by_xpath('/html/body/div[4]/dialog/header/button')
    exit_img_popup.click()
    attachment =driver.find_element_by_xpath('/html/body/div[1]/div[4]/div/div/div/div/section/div/div[2]/div/footer/span[1]/span[1]/button')
    attachment.click()
    time.sleep(2)
    send_button = driver.find_element_by_xpath('/html/body/div[1]/div[4]/div/div/div/footer/div[1]/button')
    send_button.send_keys(Keys.ENTER)
    time.sleep(5)
    print("done")
task()
```
![](https://github.com/victim1307/Tasks/blob/main/bi0s_pentest/automatic_email_sender.gif)
